from selenium import webdriver
from selenium.webdriver.chrome.service import Service
# from selenium.webdriver.chrome.options import Options
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys 
from time import sleep
# import pandas as pd 

# Opening the chrome browser and loading the given url
# browser=webdriver.Chrome('V:\Programming\Python\chromedriver_new\chromedriver.exe')
# browser.get('http://www.moneycontrol.com')

#creating dataframe from a single list
# companyList=["Tata Power","InfoBeans Technologies","Wipro","Tata Teleservices"]
# df=pd.DataFrame(companyList)
# print(df)

#creating dataframe from a dictionary
# data={'Company Name':["Tata Power","InfoBeans Technologies","Wipro","Tata Teleservices"],'Market price':[45,46,47,48]}
# df=pd.DataFrame(data)
# print(df)

# to avoid the ERROR:chrome_browser_main_extra_parts_metrics
options = webdriver.ChromeOptions()
options.add_experimental_option('excludeSwitches', ['enable-logging'])

#extracting names and links of automotive sector companies
# since the direct executable_path will be deprecated in the upcoming releases use service
ser=Service('V:\Programming\Python\chromedriver_new\chromedriver.exe')
wd=webdriver.Chrome(service=ser,options=options)
wd.get('https://www.moneycontrol.com/india/stockmarket/sector-classification/marketstatistics/bse/automotive.html?classic=true')
sleep(2)

# X-Path of first and last element of Company Name  
# //*[@id="mc_mainWrapper"]/div[2]/div[1]/div[5]/div[3]/div/table/tbody/tr[2]/td[1]/a/b
# //*[@id="mc_mainWrapper"]/div[2]/div[1]/div[5]/div[3]/div/table/tbody/tr[107]/td[1]/a/b
# X-Path of first and last element of Company Link
# //*[@id="mc_mainWrapper"]/div[2]/div[1]/div[5]/div[3]/div/table/tbody/tr[2]/td[1]/a
# //*[@id="mc_mainWrapper"]/div[2]/div[1]/div[5]/div[3]/div/table/tbody/tr[107]/td[1]/a

# companyDict = {}
# companyName=""
# companyLink=""
# for i in range(2,107):
#     # fast strings essential for updating xpath using i
#     companyName=wd.find_element(By.XPATH, f'//*[@id="mc_mainWrapper"]/div[2]/div[1]/div[5]/div[3]/div/table/tbody/tr[{i}]/td[1]/a/b').text
#     companyLink=wd.find_element(By.XPATH, f'//*[@id="mc_mainWrapper"]/div[2]/div[1]/div[5]/div[3]/div/table/tbody/tr[{i}]/td[1]/a').get_attribute("href")
#     companyDict.update({companyName:companyLink})
# print(companyDict)

# updating the dictionary with the data extracted using above code
# Word Wrap done using ALT+Z shortcut
Sector1={'IP Rings': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/iprings/IPR', 'JBM Auto': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/jbmauto/JBM03', 'Rajratan Global': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/rajratanglobalwire/RGW01', 'Autoline Ind': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/autolineindustries/AI59', 'Hind Composites': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/hindustancomposites/HC06', 'Munjal Showa': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/munjalshowa/MS', 'Sandhar Technol': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/sandhartechnologies/STl06', 'Omax Autos': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/omaxautos/OA', 'Jay Ushin': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/jayushin/JU', 'Auto Corp Goa': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/automobilecorporationgoa/ACG', 'Sundaram-Clayto': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/sundaramclayton/SC', 'Talbros Auto': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/talbrosautomotivecomponents/TAC', 'Menon Pistons': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/menonpistons/MP18', 'Banco Products': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/bancoproductsindia/BPI', 'Federal-Mogul': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/federalmogulgoetze/FMG', 'Escorts': 'https://www.moneycontrol.com/india/stockpricequote/autotractors/escorts/E', 'Sansera Eng': 'https://www.moneycontrol.com/india/stockpricequote/autoancillariesothers/sanseraengineering/SE27', 'Steel Str Wheel': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/steelstripswheels/SSW02', 'Sal Automotive': 'https://www.moneycontrol.com/india/stockpricequote/autotractors/salautomotive/SA15', 'M&M': 'https://www.moneycontrol.com/india/stockpricequote/autocarsjeeps/mahindramahindra/MM', 'Bajaj Auto': 'https://www.moneycontrol.com/india/stockpricequote/auto23wheelers/bajajauto/BA10', 'Mah Scooters': 'https://www.moneycontrol.com/india/stockpricequote/auto23wheelers/maharashtrascooters/MS01', 'Ceat': 'https://www.moneycontrol.com/india/stockpricequote/tyres/ceat/C07', 'Frontier Spring': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/frontiersprings/FS02', 'TVS Motor': 'https://www.moneycontrol.com/india/stockpricequote/auto23wheelers/tvsmotorcompany/TVS', 'The Hi-Tech Gea': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/thehitechgears/HTG', 'Jagan Litech': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/jaganlitechlamps/JLL', 'Hero Motocorp': 'https://www.moneycontrol.com/india/stockpricequote/auto23wheelers/heromotocorp/HHM', 'FIEM Ind': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/fiemindustries/FIE', 'Maruti Suzuki': 'https://www.moneycontrol.com/india/stockpricequote/autocarsjeeps/marutisuzukiindia/MS24', 'TVS Srichakra': 'https://www.moneycontrol.com/india/stockpricequote/tyres/tvssrichakra/TVS03', 'Jay BharatMarut': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/jaybharatmaruti/JBM', 'UCAL Fuel': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/ucalfuelsystems/UFS', 'Setco Auto': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/setcoautomotive/SA14', 'Hind Hardy': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/hindustanhardy/HHS', 'Minda Corp': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/mindacorporation/MC23', 'Porwal Auto': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/porwalautocomponents/PAC02', 'Atul Auto': 'https://www.moneycontrol.com/india/stockpricequote/auto23wheelers/atulauto/AA08', 'Rico Auto': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/ricoauto/RA04', 'Force Motors': 'https://www.moneycontrol.com/india/stockpricequote/autolcvshcvs/forcemotors/FM01', 'Modi Rubber': 'https://www.moneycontrol.com/india/stockpricequote/tyres/modirubber/MR01', 'Subros': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/subros/S07', 'Rane Holdings': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/raneholdings/RH01', 'Exide Ind': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/exideindustries/EI', 'Sona BLW': 'https://www.moneycontrol.com/india/stockpricequote/autoancillariescastingsforgings/sonablwprecisionforgings/SBP04', 'Samkrg Pistons': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/samkrgpistonsrings/SPR01', 'Enkei Wheels': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/enkeiwheelsindia/EWI', 'Suprajit Eng': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/suprajitengineering/SE15', 'Duncan Eng': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/duncanengineering/SD05', 'Gabriel India': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/gabrielindia/GI02', 'Hind Motors': 'https://www.moneycontrol.com/india/stockpricequote/autocarsjeeps/hindustanmotors/HM', 'Sharda Motor': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/shardamotorindustries/SMI04', 'Tata Motors': 'https://www.moneycontrol.com/india/stockpricequote/autolcvshcvs/tatamotors/TM03', 'Goodyear': 'https://www.moneycontrol.com/india/stockpricequote/tyres/goodyearindia/GI11', 'Eicher Motors': 'https://www.moneycontrol.com/india/stockpricequote/autolcvshcvs/eichermotors/EM', 'Ndr Auto Compon': 'https://www.moneycontrol.com/india/stockpricequote/ndrautocomponents/ndrautocomponents/NAC02', 'Majestic Auto': 'https://www.moneycontrol.com/india/stockpricequote/auto23wheelers/majesticauto/MA01', 'Scooters India': 'https://www.moneycontrol.com/india/stockpricequote/auto23wheelers/scootersindia/SI09', 'Lumax Inds': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/lumaxindustries/LI05', 'Munjal Auto Ind': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/munjalautoindustries/MAI04', 'PPAP Automotive': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/ppapautomotive/PPP03', 'Amara Raja Batt': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/amararajabatteries/ARB', 'MRF': 'https://www.moneycontrol.com/india/stockpricequote/tyres/mrf/MRF', 'Krypton': 'https://www.moneycontrol.com/india/stockpricequote/tyres/kryptonindustries/KI14', 'Bosch': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/bosch/B05', 'RACL Geartech': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/raclgeartech/RAC', 'Automotive Axle': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/automotiveaxles/AA06', 'Ashok Leyland': 'https://www.moneycontrol.com/india/stockpricequote/autolcvshcvs/ashokleyland/AL', 'Jamna Auto': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/jamnaautoindustries/JAI', 'WABCO India': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/wabcoindia/WAB', 'Endurance Techn': 'https://www.moneycontrol.com/india/stockpricequote/auto23wheelers/endurancetechnologies/ET01', 'Rane Brake': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/ranebrakelinings/RBL01', 'Bharat Gears': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/bharatgears/BG01', 'PTL Enterprises': 'https://www.moneycontrol.com/india/stockpricequote/tyres/ptlenterprises/PTL06', 'Pricol': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/pricol/P9', 'VST Tillers': 'https://www.moneycontrol.com/india/stockpricequote/autotractors/vsttillerstractors/VST01', 'Rane Engine': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/raneenginevalves/REV', 'Wheels': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/wheelsindia/WI11', 'SML Isuzu': 'https://www.moneycontrol.com/india/stockpricequote/autolcvshcvs/smlisuzu/SM', 'Kinetic Eng': 'https://www.moneycontrol.com/india/stockpricequote/auto23wheelers/kineticengineering/KE', 'JTEKT India': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/jtektindia/SKS04', 'India Nippon': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/indianipponelectricals/INE', 'CarTrade Tech': 'https://www.moneycontrol.com/india/stockpricequote/automobiledealersdistributors/cartradetech/CT12', 'Sundaram Brake': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/sundarambrakelinings/SBL', 'Apollo Tyres': 'https://www.moneycontrol.com/india/stockpricequote/tyres/apollotyres/AT14', 'JK Tyre & Ind': 'https://www.moneycontrol.com/india/stockpricequote/tyres/jktyreindustries/JKT01', 'Him Teknoforge': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/himteknoforge/GAG', 'Triton Valves': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/tritonvalves/TV', 'Sibar Auto': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/sibarautoparts/SAP01', 'ZF Steering Gea': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/zfsteeringgearindia/ZFS', 'Lumax Auto Tech': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/lumaxautotechnologies/LAT01', 'Standard Batter': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/standardbatteries/SB07', 'Bharat Seats': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/bharatseats/BS03', 'Tirupati Tyres': 'https://www.moneycontrol.com/india/stockpricequote/tyres/tirupatityres/TT15', 'Machino Plastic': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/machinoplastics/MP', 'Balkrishna Ind': 'https://www.moneycontrol.com/india/stockpricequote/tyres/balkrishnaindustries/BI03', 'Minda Ind': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/mindaindustries/MI4', 'Precision Camsh': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/precisioncamshafts/PC16', 'Shivam Auto': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/shivamautotech/SA13', 'Motherson Sumi': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/mothersonsumisystems/MSS01', 'HMT': 'https://www.moneycontrol.com/india/stockpricequote/autotractors/hmt/HMT', 'Rasandik Engg': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/rasandikengineeringindustriesindia/REI02', 'Spectra Ind': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/spectraindustries/SI33', 'Auto Stampings': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/automotivestampingsassemblies/ASA01', 'Remsons Ind': 'https://www.moneycontrol.com/india/stockpricequote/autoancillaries/remsonsindustries/RI10'}

# Sector2={'Nestle': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/nestleindia/NI', 'Britannia': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/britanniaindustries/BI', 'Adani Wilmar': 'https://www.moneycontrol.com/india/stockpricequote/consumerfood/adaniwilmar/AW', 'Jubilant Food': 'https://www.moneycontrol.com/india/stockpricequote/miscellaneous/jubilantfoodworks/JF04', 'Hatsun Agro': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/hatsunagroproducts/HAP', 'Devyani Int': 'https://www.moneycontrol.com/india/stockpricequote/consumerfood/devyaniinternational/DI06', 'Godrej Agrovet': 'https://www.moneycontrol.com/india/stockpricequote/miscellaneous/godrejagrovet/GA03', 'Zydus Wellness': 'https://www.moneycontrol.com/india/stockpricequote/vanaspatioils/zyduswellness/ZW01', 'Barbeque Nat': 'https://www.moneycontrol.com/india/stockpricequote/consumerfood/barbequenationhospitality/BNH', 'Burger King': 'https://www.moneycontrol.com/india/stockpricequote/consumerfood/burgerkingindia/BKI01', 'Hindustan Foods': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/hindustanfoods/HFL', 'Tasty Bite': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/tastybiteeatables/TBE', 'Dodla Dairy': 'https://www.moneycontrol.com/india/stockpricequote/consumerfood/dodladairy/DD01', 'Bectors Food': 'https://www.moneycontrol.com/india/stockpricequote/consumerfood/mrsbectorsfoodspecialities/MBF01', 'Prataap Snacks': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/prataapsnacks/PS20', 'ADF Foods': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/adffoodsindustries/AF30', 'Gulshan Poly': 'https://www.moneycontrol.com/india/stockpricequote/chemicals/gulshanpolyols/GP9', 'Heritage Foods': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/heritagefoods/HFI', 'Future Consumer': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/futureconsumer/FVI', 'DFM Foods': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/dfmfoods/DFM', 'Parag Milk Food': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/paragmilkfoods/PMF01', 'Vadilal Ind': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/vadilalindustries/VI01', 'Sukhjit Starch': 'https://www.moneycontrol.com/india/stockpricequote/miscellaneous/sukhjitstarchchemicals/SSC02', 'KSE': 'https://www.moneycontrol.com/india/stockpricequote/edibleoilssolventextraction/kse/KSE', 'IFB Agro': 'https://www.moneycontrol.com/india/stockpricequote/breweriesdistilleries/ifbagroindustries/IFB', 'Foods and Inns': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/foodsinns/FI10', 'Sheetal Cool Pr': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/sheetalcoolproducts/SCP', 'Amrit Corp': 'https://www.moneycontrol.com/india/stockpricequote/vanaspatioils/amritcorporation/AC20', 'Nakoda Group': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/nakodagroupindustries/NGo', 'Bambino Agro': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/bambinoagroindustries/BAI02', 'Milkfood': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/milkfood/M04', 'Gayatri Bio': 'https://www.moneycontrol.com/india/stockpricequote/trading/gayatribioorganics/SI37', 'Umang Dairies': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/umangdairies/UD01', 'Vadilal Enter': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/vadilalenterprises/VE', 'Lotus Chocolate': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/lotuschocolatecompany/LCC01', 'Flex Foods': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/flexfoods/FF03', 'Freshtrop Fruit': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/freshtropfruits/FF05', 'Anik Industries': 'https://www.moneycontrol.com/india/stockpricequote/edibleoilssolventextraction/anikindustries/AI57', 'Megastar Foods': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/megastarfoods/MF13', 'Anjani Foods': 'https://www.moneycontrol.com/india/stockpricequote/anjanifoods/anjanifoods/RFI', 'MSR India': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/msrindia/SL11', 'Virat Crane': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/viratcraneindustries/VCI03', 'Oceanic Foods': 'https://www.moneycontrol.com/india/stockpricequote/miscellaneous/oceanicfoods/OF03', 'Chordia Food': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/chordiafoodproducts/CFP', 'Saboo Sodium': 'https://www.moneycontrol.com/india/stockpricequote/chemicals/saboosodiumchloro/SSC', 'Tasty Dairy Spe': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/tastydairyspecialitieslimited/TDS', 'Tirupati Starch': 'https://www.moneycontrol.com/india/stockpricequote/miscellaneous/tirupatistarchchemicals/TSC', 'Tanvi Foods': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/tanvifoods/TF06', 'Modern Dairies': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/moderndairies/MD', 'Prima Agro': 'https://www.moneycontrol.com/india/stockpricequote/miscellaneous/primaagroproducts/PAP01', 'Sampre Nutritio': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/samprenutritions/SN01', 'Jetmall Spices': 'https://www.moneycontrol.com/india/stockpricequote/consumerfood/jetmallspicesmasala/JSM', 'Jhandewalas Foo': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/jhandewalasfoodsltd/JF05', 'Mahaan Foods': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/mahaanfoods/MF02', 'Tricom Fruit': 'https://www.moneycontrol.com/india/stockpricequote/foodprocessing/tricomfruitproducts/RID', 'Suryo Food': 'https://www.moneycontrol.com/india/stockpricequote/aquaculture/suryofoodindustries/SFI'}

for key,value in Sector1.items():
    freeCashflow=0
    pe=0
    icrList=[]
    roeList=[]
    roceList=[]
    pb=0
    
    wd.get(value)
    sleep(2)
    
    #cash flow button
    wd.find_element(By .XPATH,'//*[@id="consolidated"]/div[1]/ul/li[4]/a').click()
    sleep(2)
    #cash flow data
    freeCashFlow=wd.find_element(By .XPATH,'//*[@id="cash-flow"]/div[1]/table/tbody/tr[5]/td[2]').text
    print(freeCashflow)
    

wd.close()



